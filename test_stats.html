<!DOCTYPE html>
<html>
<head>
    <title>Test Game Stats</title>
    <style>
        body { background: #0d1b2a; color: #00d4ff; font-family: Arial; padding: 20px; }
        .test { border: 1px solid #00d4ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        h2 { color: #2ed573; }
    </style>
</head>
<body>
    <h1>üîç Game Stats Debug Test</h1>
    
    <div class="test">
        <h2>1. Check localStorage</h2>
        <pre id="storage-check"></pre>
    </div>
    
    <div class="test">
        <h2>2. Try loading game scores</h2>
        <pre id="scores-check"></pre>
    </div>
    
    <div class="test">
        <h2>3. Build Leaderboard</h2>
        <div id="leaderboard-test"></div>
    </div>

    <script>
        // Check storage
        document.getElementById('storage-check').innerHTML = `
Keys in localStorage: ${Object.keys(localStorage).length}
${Object.keys(localStorage).map(k => `‚Ä¢ ${k}`).join('\n')}

gameScores value:
${localStorage.getItem('gameScores')}
        `.trim();

        // Get and parse scores
        function getGameScores() {
            try {
                const scores = localStorage.getItem('gameScores');
                return scores ? JSON.parse(scores) : [];
            } catch(e) {
                return [];
            }
        }

        const scores = getGameScores();
        document.getElementById('scores-check').innerHTML = `
Total Scores: ${scores.length}
${scores.length > 0 ? scores.map(s => `‚Ä¢ ${s.username}: ${s.score} pts`).join('\n') : 'NO SCORES YET'}
        `.trim();

        // Build leaderboard
        if (scores.length === 0) {
            document.getElementById('leaderboard-test').innerHTML = '<p style="color: #b0b0b0;">No game scores yet. Play the game first!</p>';
        } else {
            const grouped = {};
            scores.forEach(s => {
                if (!grouped[s.username]) {
                    grouped[s.username] = { total: 0, games: 0, best: 0 };
                }
                grouped[s.username].total += s.score;
                grouped[s.username].games++;
                grouped[s.username].best = Math.max(grouped[s.username].best, s.score);
            });

            const board = Object.entries(grouped)
                .map(([name, stats]) => ({ name, ...stats }))
                .sort((a, b) => b.total - a.total)
                .slice(0, 20);

            let html = '<table border="1" style="color: #00d4ff; border-collapse: collapse;"><tr><th>Rank</th><th>Player</th><th>Total</th><th>Games</th><th>Best</th></tr>';
            board.forEach((p, i) => {
                html += `<tr><td>${i+1}</td><td>${p.name}</td><td>${p.total}</td><td>${p.games}</td><td>${p.best}</td></tr>`;
            });
            html += '</table>';
            document.getElementById('leaderboard-test').innerHTML = html;
        }
    </script>
</body>
</html>
